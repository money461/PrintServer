<#include "/system/include.html" encoding="UTF-8" parse=true/>
<!DOCTYPE html>
<html lang="zh">
<head>
	<!-- 引入样式css -->
	<@commoncss title='标签入库日志列表'/>
</head>
<body class="gray-bg">
     <div class="container-div">
		<div class="row">
			
			<div class="col-sm-12 search-collapse">
				<form id="post-form">
					<div class="select-list">
						<ul>
							<li>
								打印标签：<input class="select2 form-control" href="/labelPrint/template/getAllCode" inputMessage="请输入选择打印标签" id='code' name="code"></input>
							</li>
							<li>
							          消息来源：<input type="text" name="senderName"/>
							</li>
							<li>
							          单据号：<input type="text" name="mawb"/>
							</li>
							<li>
							          分单：<input type="text" name="hawb"/>
							</li>
							<li>
								处理情况：						
								<select name="status">
									<option value="0" check='checked'>成功</option>
									<option value="1">失败</option>
									<option value="3">异常</option>
								</select>
								
							</li>
							<li>
								<label>处理时间： </label>
								<input type="text" class=""  id="startDate"  placeholder="开始时间" name="params[beginTime]"/>
								<span>-</span>
								<input type="text" class="" id="endDate"  placeholder="结束时间" name="params[endTime]"/>
							</li>
							
							<li>
								<@shiro.hasAnyPermissions name="${code}.btn-search">
								<a class="btn btn-primary btn-rounded btn-sm" onclick="$.table.search()"><i class="fa fa-search"></i>&nbsp;搜索</a>
								</@shiro.hasAnyPermissions>
								<@shiro.hasAnyPermissions name="${code}.btn-realod">
							    <a class="btn btn-warning btn-rounded btn-sm" onclick="$.form.reset()"><i class="fa fa-refresh"></i>&nbsp;重置</a>
								</@shiro.hasAnyPermissions>
							</li>
							
						</ul>
					</div>
				</form>
			</div>
			
			<div  class="col-sm-12 select-table table-striped table-responsive">
						<table class="text-nowrap" id="bootstrap-table"  data-use-row-attr-func="true" data-reorderable-rows="true"  data-reorderable-columns="true" data-mobile-responsive="true" style="table-layout:fixed;"></table>
			</div>
		</div>
	</div>
<!-- 引入通用js -->
	<@commonjs/>
	<!-- 自定义js -->
	<script src="${request.contextPath}/js/admin/log.js"></script>
	<script  type="text/javascript">
        var prefix = ctx + "/log";

        //回调函数
        function selected(data){
			$("#code").val(data.id);
		}
        
        $(function() {
        	
        	log.initdate(); //初始化时间
        	
        	log.select2(null,selected);
          
        });
        
        window.onload = function () {
        	  var options = {
                    url: prefix + "/logdetail",
                    showSearch: true,
      		        showRefresh: true,
      		        showToggle: true,
      		        showColumns: true,
      		        detailView: true,
      		        showExport:true, //是否显示导出
      		        exportDataType:'selected',
      		        detailFormatter:$.table.detailFormatter,
      		        sortName: "updateTime", //默认排序字段
      		        sortOrder: "desc",
      		        pageSize:50,
      		        pageList: [20, 50, 100],
      		        modalName: "标签入库日志",
                      columns: [{
      		            checkbox: true,
                      },{
                      	field : 'id',
                      	title : '索引编号',
      		            visible: false
      		            
      		        },
      				{
      					field : 'seqNo', 
      					title : '消息ID',
      					visible: false
      				},
      				{
      					field : 'senderName', 
      					title : '消息来源',
      					visible: false
      				},
      				{
      					field : 'reciverName', 
      					title : '消息接受系统',
      					visible: false
      				},
      				{
      					field : 'doctypeName', 
      					title : '消息类型声明',
      					align: 'center'
      					
      				},{
      					field : 'code', 
      					title : '打印标签code',
      					align: 'center',
      					visible	: false
      				},{
      					field : 'codeName', 
      					title : '打印标签',
      					align: 'center'
      				},
      				{
      					field : 'mawb', 
      					title : '单据号',
      					align: 'center',
      				},
      				{
      				    field : 'hawb',
      				    title : '分单号',
      				    visible	: false
      				},
      				{
      				    field : 'handleType',
      				    title : '处理类型',
      				    visible	: false
      				},{
      					field : 'detail',
      					title : '结果描述',
      					switchable: false,
           			    //formatter:operateFormatter,
           				//events:operateEvents,
      					width:158,
      					cellStyle:{
      						css:{
      							"overflow": "hidden",
      							"text-overflow": "ellipsis",
      							"white-space": "nowrap",
      							"max-width":"150px"
      							}
      					}
      				},{
      					field : 'json',
      					title : '消息报文',
      					align: 'center',
      					visible	: true,
      					switchable: false,
           			    //formatter:operateFormatter,
           				//events:operateEvents,
      					width:158,
      					cellStyle:{
      						css:{
      							"overflow": "hidden",
      							"text-overflow": "ellipsis",
      							"white-space": "nowrap",
      							"max-width":"150px"
      							}
      					}
      				},
      				{
                          field: 'status',
                          title: '入库状态',
                          align: 'center',
                          formatter: function(value, row, index) {
                          	return log.selectDictLabel(value);
                          }
                      },
      				{
                          field: 'updateTime',
                          title: '消息处理日期',
                          align: 'center',
                          sortable: true
                      },
      				{
                          field: 'createTime',
                          title: '消息创建时间',
                          sortable: true,
                          visible: false
                      }
                      
      		       /*  {
      		            title: '操作',
      		            align: 'center',
      		            formatter: function(value, row, index) {
      		            	var actions = [];
      		            	actions.push('<a class="btn btn-success btn-xs" href="#"><i class="fa fa-edit"></i>编辑</a> ');
                              actions.push('<a class="btn btn-danger btn-xs" href="#"><i class="fa fa-remove"></i>删除</a>');
      						return actions.join('');
      		            }
      		        } */
      		        ]
                  };
                  $.table.init(options);
        
      }
    </script>

</body>
</html>